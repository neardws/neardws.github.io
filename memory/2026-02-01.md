# 2026-02-01 Session Summary

## 记忆系统升级 (全部完成)

### Phase 1: 向量化 local-memory ✅
- 接入本地 embedding 服务 (localhost:8001, Chroma + Gemini Embedding)
- 向量语义搜索替代关键词匹配
- 修复: 插件路径冲突、JSON文件路径、API响应格式(一维vs二维数组)

### Phase 2: 自动整理 ✅
- 去重: 相似度 >95% 自动合并
- 过期清理: context 类 30天后删除
- 定时任务: 每天 03:00

### Phase 3: 统一架构 ✅
- 知识提炼: 从 memory/*.md 自动提取到 local-memory
- 统一查询: unified-search.py (优先 local-memory，补充 memorySearch)
- 定时任务: 每天 03:30

## 可靠性升级 (全部完成)

### 多模型冗余 ✅
- Fallback 链: Opus → Kimi K2.5 → MiniMax M2.1
- Kimi API: https://api.kimi.com/coding (anthropic-messages 格式)

### 会话持久化 ✅
- 检查点机制: ~/.clawdbot/sessions/checkpoints/
- 状态保存: session-persist.py

### 错误自愈 ✅
- 自动诊断: Gateway、磁盘、Embedding、TTS、Config、Mac Mini
- 自动修复: 重启、配置回滚、清理磁盘
- 定时任务: 每 30 分钟

### 双向冗余 ✅
- Ubuntu → Mac Mini: 检测+远程回滚修复
- Mac Mini → Ubuntu: 检测+远程回滚修复
- Mac Mini 健康检查: 每 5 分钟

## 新增脚本 (~/.clawdbot/scripts/)

| 脚本 | 功能 |
|------|------|
| backup-config.sh | 配置备份 |
| auto-rollback.sh | 自动回滚 |
| gateway-wrapper.sh | systemd 集成 |
| memory-maintenance.py | 记忆维护(去重+清理) |
| extract-knowledge.py | 知识提炼 |
| unified-search.py | 统一查询 |
| session-persist.py | 会话持久化 |
| self-heal.py | 错误自愈 |

## 定时任务汇总

```
*/5 * * * *   Mac Mini 健康检查
*/30 * * * *  自愈诊断
0 3 * * *     记忆维护
30 3 * * *    知识提取
```

## 新增配置

- Kimi K2.5 provider (anthropic-messages API)
- Fallbacks: ["kimi/kimi-k2-0711", "minimax/MiniMax-M2.1"]

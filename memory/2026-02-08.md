# 2026-02-08 Daily Log

## OpenClaw 升级
- 从 `v2026.2.6-g4c1da23` 升级到 `v2026.2.6-3` (bc475f017)
- 合入 67 个 commit，包括：context overflow compaction 修复、cron 调度改进、QMD 内存加固、agents.create/update/delete API、tool-result-truncation、UI 滚动优化等
- 本地修改（nano-banana-pro SKILL.md + generate_image.py）通过 git stash → pull → stash pop 无冲突保留
- 本地 untracked 文件（1432个，含自定义 skills、docs、info-monitor）全部保留
- pnpm install + build 成功，pi 依赖从 0.52.7 → 0.52.8
- Gateway 重启受限（commands.restart=true 未设置），用 `clawdbot gateway restart` 命令重启

## P0 灾备：Healthchecks.io 外部心跳监控
- **Ping Key**: `tfxvxbu4z5ipsqlxrki9jg`
- 创建了5个检查点（auto-provisioning 模式，slug URLs）:
  - `ubuntu-alive` — Ubuntu 系统存活
  - `openclaw-gateway` — Gateway 进程 + HTTP 健康（pgrep + curl :18789/health）
  - `mac-mini-alive` — Mac Mini 存活
  - `cloudflare-tunnel` — 外网隧道可达（302=Cloudflare Access 重定向算正常）
  - `email-forward` — 邮件转发日志无错误
- **Ubuntu 脚本**: `/home/neardws/server-scripts/monitor/healthchecks-ping.sh`
  - Cron: `*/5 * * * *` → 日志写 `~/User_Services/services-logs/healthchecks.log`
- **Mac Mini 脚本**: `~/.clawdbot/healthchecks-ping.sh`
  - Cron: `*/5 * * * *` → 日志写 `~/.clawdbot/healthchecks.log`
- 所有5个 check 均已成功 ping（HTTP 200）
- **待 Neil 手动完成**: 在 Healthchecks.io 网页调整 Period=5min / Grace=10min，配置 Email 通知

## 灾备规划文档
- 写入 `~/clawd/docs/DISASTER-RECOVERY-PLAN.md`
- 涵盖双系统（Ubuntu + Mac Mini）完整现状分析
- P0 外部心跳（已完成）→ P1 GPG 加密备份 → P1.5 状态快照版本化 → P2 从零恢复手册
- P1 待执行：GPG 密钥生成 + secrets-backup.sh + 每周 cron

## 系统现状记录
- **Ubuntu cron jobs** (8个): 邮件转发×3, self-heal, info-monitor, autodl-heartbeat, security-scan, healthchecks-ping
- **Mac Mini cron jobs** (4个): health-check, health-monitor, gateway-failover, healthchecks-ping
- **Docker 容器**: rsshub, notebooklm-mcp, metamcp(+nginx+pg), autodl×4, dongguatv, 1Panel-frpc, natfrp
- **Systemd 服务**: embedding, clawd-voice, axis-voice-http, cliproxyapi, ft-agent, cloudflared
- **Cloudflared 隧道**: clawdbot/1panel/mcp/embedding/cliproxy/fish/kanban/voice/voicews → .neardws.com
- 发现 Cloudflare Access 保护了 clawdbot.neardws.com（302 重定向到登录页）
- Mac Mini cloudflared 配置在 `/etc/cloudflared/config.yml`（与 Ubuntu 不同 tunnel）
